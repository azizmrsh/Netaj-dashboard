# دليل الاستخدام السريع - تقرير كشف حساب المخزون
## Quick User Guide - Inventory Account Statement

---

## 🚀 كيفية استخدام التقرير المحدث

### 1️⃣ فتح صفحة التقرير

```
Dashboard → Customers → اختر العميل → Report
```

أو

```
Dashboard → Reports → Customer Inventory Report
```

---

### 2️⃣ ملء البيانات المطلوبة

#### ✅ الحقول الإلزامية:

| الحقل | الوصف | القيمة الافتراضية | مثال |
|------|-------|-------------------|------|
| **Customer** | اختر العميل | - | Al-Gary Company |
| **Date From** | تاريخ البداية | بداية الشهر | 01/08/2025 |
| **Date To** | تاريخ النهاية | نهاية الشهر | 31/08/2025 |
| **Opening Balance** | الرصيد الافتتاحي | 0 | 0.00 |
| **Unit Rate** | سعر الوحدة (ريال/طن) | 115 | 115 |
| **Tax Rate** | معدل الضريبة (%) | 15 | 15 |

#### ⚙️ الخيارات الاختيارية:

| الحقل | الوصف | متى تستخدمه |
|------|-------|-------------|
| **Product Filter** | تصفية حسب منتج محدد | لعرض تقرير منتج واحد فقط (مثل: ASPHALT 60/70) |
| **Show separately** | عرض كل منتج في صف منفصل | للحصول على تقرير مفصل مثل Excel |

---

### 3️⃣ أمثلة الاستخدام

#### 📌 مثال 1: تقرير شامل لكل المنتجات

```
✓ Customer: Al-Gary Company
✓ Product Filter: [فارغ - All Products]
✓ Date From: 01/08/2025
✓ Date To: 31/08/2025
✓ Opening Balance: 0
✓ Unit Rate: 115
✓ Tax Rate: 15
✗ Show separately: غير مفعّل

النتيجة:
- صف واحد لكل مستند
- المستند الواحد يجمع كل المنتجات
- مثال: "Receipt-0008: ASPHALT 60/70, PG 76"
```

---

#### 📌 مثال 2: تقرير منتج واحد فقط (Bin Card)

```
✓ Customer: Al-Gary Company
✓ Product Filter: ASPHALT 60/70 ← اختر المنتج
✓ Date From: 01/08/2025
✓ Date To: 31/08/2025
✓ Opening Balance: 0
✓ Unit Rate: 115
✓ Tax Rate: 15
✗ Show separately: غير مفعّل

النتيجة:
- يعرض فقط العمليات الخاصة بـ ASPHALT 60/70
- مفيد لـ Bin Card لكل منتج
```

---

#### 📌 مثال 3: تقرير مفصل (كل منتج في صف منفصل)

```
✓ Customer: Al-Gary Company
✓ Product Filter: [فارغ]
✓ Date From: 01/08/2025
✓ Date To: 31/08/2025
✓ Opening Balance: 0
✓ Unit Rate: 115
✓ Tax Rate: 15
✓ Show separately: مفعّل ← فعّل هذا الخيار

النتيجة:
Receipt-0008 | ASPHALT 60/70 | 26.02
Receipt-0008 | PG 76        | 10.00
Receipt-0008 | Product3     | 5.00

(بدلاً من صف واحد يجمع 41.02)
```

---

#### 📌 مثال 4: تقرير بسعر مخصص

```
✓ Customer: Al-Gary Company
✓ Product Filter: [فارغ]
✓ Date From: 01/08/2025
✓ Date To: 31/08/2025
✓ Opening Balance: 0
✓ Unit Rate: 120 ← سعر مختلف
✓ Tax Rate: 15
✗ Show separately: غير مفعّل

النتيجة:
- جميع الحسابات تستخدم 120 ريال/طن
- Value = Issues × 120
```

---

## 📊 قراءة التقرير

### بنية الجدول:

| No | Date | Document No | Product Name | Receipts | Issues | Balance | Rate | Value |
|----|------|-------------|--------------|----------|--------|---------|------|-------|
| * | * | Opening Balance | Opening Balance | * | * | 0.00 | * | * |
| 1 | 02/08/2025 | Receipt-0008 | ASPHALT 60/70 | 26.02 | | 26.02 | | |
| 2 | 02/08/2025 | Delivery-0006 | PG 76 S-10 | | 25.06 | 0.96 | 115 | 2881.9 |

---

### فهم الأعمدة:

| العمود | الوصف | متى يظهر |
|--------|-------|----------|
| **No** | رقم السطر | دائماً (* في Opening Balance) |
| **Date** | تاريخ العملية | دائماً (* في Opening Balance) |
| **Document No** | رقم المستند | دائماً (OPENING BALANCE في السطر الأول) |
| **Product Name** | اسم المنتج أو الوصف | دائماً |
| **Receipts** | الكمية الواردة (طن) | فقط في عمليات الاستلام |
| **Issues** | الكمية الصادرة (طن) | فقط في عمليات التسليم |
| **Balance** | الرصيد التراكمي (طن) | دائماً |
| **Rate** | السعر (ريال/طن) | فقط في عمليات التسليم |
| **Value** | القيمة (ريال) | فقط في عمليات التسليم |

---

### الجدول الختامي (Summary):

| البند | المعنى | الحساب |
|-------|--------|--------|
| **Total Receipts** | إجمالي الواردات | مجموع كل Receipts |
| **Total of Issues** | إجمالي الصادرات | مجموع كل Issues |
| **Balance** | الرصيد النهائي | Receipts - Issues + Opening Balance |
| **Total Amount Before Tax** | المبلغ قبل الضريبة | Total Issues × Unit Rate |
| **Add VAT** | ضريبة القيمة المضافة | Total Amount × (Tax Rate / 100) |
| **Total Amount after Tax** | المبلغ بعد الضريبة | Before Tax + VAT |

---

## 💡 نصائح مهمة

### ✅ أفضل الممارسات:

1. **الرصيد الافتتاحي:**
   - أدخله يدوياً إذا كنت تعرفه
   - أو اتركه 0 إذا كانت هذه أول فترة

2. **سعر الوحدة (Unit Rate):**
   - استخدم السعر المتفق عليه مع العميل
   - القيمة الافتراضية 115 ريال/طن
   - يمكن تغييره حسب الفترة

3. **معدل الضريبة (Tax Rate):**
   - القيمة الافتراضية 15% (ضريبة القيمة المضافة في السعودية)
   - يمكن تغييره إذا اختلف المعدل

4. **تصفية المنتج:**
   - استخدمها لتقارير Bin Card لكل منتج
   - اتركها فارغة للتقرير الشامل

5. **عرض منفصل:**
   - استخدمه إذا كنت تريد تفاصيل أكثر
   - مفيد عند وجود مستندات متعددة المنتجات

---

### ⚠️ تحذيرات:

1. **لا تخلط بين Unit Rate و Tax Rate:**
   - Unit Rate = سعر الوحدة (115 ريال)
   - Tax Rate = معدل الضريبة (15%)
   - هما مستقلان تماماً!

2. **الرصيد السالب:**
   - إذا ظهر رصيد سالب، هذا يعني أن الصادرات أكبر من الواردات
   - تحقق من Opening Balance
   - قد يكون هناك عمليات قبل الفترة المحددة

3. **القيمة (Value):**
   - تظهر فقط في الصادرات (Deliveries)
   - لا تظهر في الواردات (Receipts)
   - الحساب: Issues × Unit Rate

---

## 📥 تصدير التقرير

### تصدير Excel:

1. اضغط على زر **"Export to Excel"**
2. سيتم تنزيل ملف Excel بالتنسيق التالي:

```
┌──────────────────────────────────────────────┐
│ Netaj Almotatwrah Commercial Company         │
│ Inventory Account Statement - Bin Card       │
│ From 01-08-2025 To 31-08-2025                │
│ Customer Name: Al-Gary Company               │
│                                              │
│ [الجدول الكامل مع التنسيق]                  │
│                                              │
│ [الجدول الختامي مع الخلفية الصفراء]         │
└──────────────────────────────────────────────┘
```

### طباعة التقرير:

1. اضغط على زر **"Print"**
2. أو استخدم `Ctrl + P`
3. التقرير منسق للطباعة تلقائياً

---

## 🔧 حل المشاكل الشائعة

### ❌ المشكلة: القيمة (Value) = 0 أو فارغة

**السبب:**
- لم يتم إدخال Unit Rate
- أو Unit Rate = 0

**الحل:**
```
تأكد من إدخال Unit Rate (مثل 115)
```

---

### ❌ المشكلة: الرصيد غير صحيح

**السبب:**
- Opening Balance غير صحيح
- أو هناك عمليات خارج الفترة المحددة

**الحل:**
```
1. تحقق من Opening Balance
2. قم بحساب الرصيد قبل الفترة يدوياً
3. أدخل الرصيد الصحيح في Opening Balance
```

---

### ❌ المشكلة: لا تظهر منتجات معينة

**السبب:**
- مفلتر حسب منتج آخر في Product Filter

**الحل:**
```
تأكد من أن Product Filter فارغ (All Products)
```

---

### ❌ المشكلة: ضريبة خاطئة

**السبب:**
- Tax Rate غير صحيح

**الحل:**
```
تأكد من Tax Rate = 15% (أو النسبة الصحيحة)
```

---

## 📞 للدعم

إذا واجهت أي مشكلة:

1. راجع هذا الدليل
2. راجع ملف `CUSTOMER_REPORT_UPDATES.md` للتفاصيل التقنية
3. راجع ملف `EXCEL_VS_CODE_COMPARISON.md` لفهم المعادلات

---

**إعداد:** GitHub Copilot  
**التاريخ:** 2025-10-21  
**الإصدار:** v2.0
